# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

# This schema defines crash annotations that Socorro knows about and details
# about them.
#
# Directions for adding support for new annotations is at:
# https://socorro.readthedocs.io/en/latest/annotations.html
#
# Crash annotations being emitted by crash reporters should additionally be
# documented in:
#
# https://searchfox.org/mozilla-central/source/toolkit/crashreporter/CrashAnnotations.yaml
#
# See README.rst for details on how to add annotations to this file, the
# template to use, and how to test them afterwards.

---
$schema: moz://mozilla.org/schemas/socorro/socorro-data/1-0-0
type: object

default_permissions: ["public", "protected"]

properties:
  metadata:
    description: >
      Meta data added by the collector capturing information about the crash
      report submission and payload.
    data_reviews:
      - added by collector
    pattern_properties:
      ^.+$:
        nickname: METADATA
        data_reviews:
          - added by collector
        description: Field generated by the collector at ingestion.
        type: ["any"]
        permissions: ["protected"]
    type: object
    permissions: ["protected"]

  submitted_timestamp:
    description: |
      Date when the crash report was accepted by the collector in ISO-8601
      format UTC.

      Added by the collector.
    data_reviews:
      - added by collector
    type: string
    permissions: ["public"]

  uuid:
    data_reviews:
      - added by collector
    description: |
      Crash id generated by the collector at ingestion. The last 6 characters
      are in the form of YYMMDD for the date the crash report was accepted.

      Added by the collector.
    type: string
    permissions: ["public"]

  version:
    data_reviews:
      - added by collector
    description: >
      Version of the raw crash structure this item was encoded with.

      Added by the collector.
    type: integer
    permissions: ["public"]

  # Add new annotations from products below this line.

  AbortMessage:
    data_reviews:
      - unknown
    description: >
      Message passed to `NS_DebugBreak()`.
    type: string
    permissions: ["public"]

  Accessibility:
    data_reviews:
      - unknown
    description: >
      Set to `Active` by the accessibility service when it is active.
    type: string
    permissions: ["public"]

  AccessibilityClient:
    data_reviews:
      - unknown
    description: >
      Accessibility client ID.
    type: string
    permissions: ["public"]

  AccessibilityInProcClient:
    data_reviews:
      - unknown
    description: >
      Hexadecimal mask of in-process accessibility consumers, see
      `accessible/windows/msaa/Compatibility.h` for the mappings.
    type: string
    permissions: ["public"]

  AdapterDeviceID:
    data_reviews:
      - unknown
    description: >
      Graphics adapter name.
    type: string
    permissions: ["public"]

  AdapterDriverVersion:
    data_reviews:
      - unknown
    description: >
      Graphics adapter driver version.
    type: string
    permissions: ["public"]

  AdapterSubsysID:
    data_reviews:
      - unknown
    description: >
      Graphics adapter subsystem ID.
    type: string
    permissions: ["public"]

  AdapterVendorID:
    data_reviews:
      - unknown
    description: >
      Graphics adapter vendor name.
    type: string
    permissions: ["public"]

  Add-ons:
    data_reviews:
      - unknown
    description: >
      List of currently enabled add-ons.
    type: string
    permissions: ["public"]

  additional_minidumps:
    data_reviews:
      - unknown
    description: >
      Comma separated list of additional minidumps for this crash, each element
      in the list represent the suffix used in the dump filename. For example,
      the `browser` entry for crash `fa909194-737b-4b93-b8da-da110ac785e0`
      implies the existence of the
      `fa909194-737b-4b93-b8da-da110ac785e0-browser.dmp` file.
    type: string
    permissions: ["protected"]

  Android_Board:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      The name of the underlying board used by the Android device.
      e.g. "k68v1_64"
    type: string
    permissions: ["public"]

  Android_Brand:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      The consumer-visible brand associated with this Android device.
      e.g. "vivo"
    type: string
    permissions: ["public"]

  Android_CPU_ABI:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      The Android primary CPU ABI being used. e.g. "arm64-v8a"
    type: string
    permissions: ["public"]

  Android_CPU_ABI2:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      The Android secondary CPU ABI being used. e.g. "armeabi-v7a"
    type: string
    permissions: ["public"]

  Android_Device:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      Android device name. e.g. "1907"
    type: string
    permissions: ["public"]

  Android_Display:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      End-user visible display name of the build id for the Android build.
      e.g. "SP1A.210812.003 release-keys"
    type: string
    permissions: ["public"]

  Android_Fingerprint:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      A string that uniquely identifies the Android build. e.g.
      "vivo/1907/1907:12/SP1A.210812.003/compiler03091510:user/release-keys"
    type: string
    permissions: ["public"]

  Android_Hardware:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      The name of the Android hardware from "/proc". e.g. "mt6768"
    type: string
    permissions: ["public"]

  Android_Manufacturer:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      Android device manufacturer. e.g. "vivo"
    type: string
    permissions: ["public"]

  Android_Model:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      End-user visible Android device model name. e.g. "vivo 1907"
    type: string
    permissions: ["public"]

  Android_Version:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1564483#c4
    description: >
      The developer preview revision of a prerelease SDK plus The current
      development codename, or the string "REL" if this is a release build.
      e.g. "31 (REL)"
    type: string
    permissions: ["public"]

  AppInitDLLs:
    data_reviews:
      - unknown
    description: >
      List of DLLs loaded when launching any application on Windows. This
      reflects the contents of the `AppInit_DLLs` registry key.
    type: string
    permissions: ["public"]

  ApplicationBuildID:
    data_reviews:
      - unknown
    description: |
      The unique build identifier for this version.

      **Fenix notes:**

      `BuildID` contains the build id for the GeckoView library used and
      `ApplicationBuildID` contains the build id for Fenix.

      Unlike other build ids, this is a number like `2015895489` which is not
      in the typical `YYYYMMDDHHMMSS` structure and you can't derive the build
      date from it.

      **Focus notes:**

      Unlike other build ids, this is a number like ` 363142253` which is not
      in the typical `YYYYMMDDHHMMSS` structure and you can't derive the build
      date from it.
    type: string
    permissions: ["public"]

  AsyncShutdownTimeout:
    data_reviews:
      - unknown
    description: >
      This annotation is present if a shutdown blocker was not released in time
      and the browser was crashed instead of waiting for shutdown to finish. The
      condition that caused the hang is contained in the annotation.
    type: string
    permissions: ["public"]

  AvailablePageFile:
    data_reviews:
      - unknown
    description: |
      Available commit-space in bytes.
      - Under Windows, computed from the `PERFORMANCE_INFORMATION` structure by
        substracting the `CommitTotal` field from the `CommitLimit` field.
      - Under Linux, computed from `/proc/meminfo` `CommitLimit - Committed_AS`.
        Note that the kernel is not guaranteed to enforce that
        `CommittedLimit >= Committed_AS`. If `Committed_AS > CommittedLimit`,
        this value is set to 0.
      - Not available on other platforms.
    type: string
    permissions: ["public"]

  AvailablePhysicalMemory:
    data_reviews:
      - unknown
    description: |
      Amount of free physical memory in bytes.
      - Under Windows, populated with the contents of the `MEMORYSTATUSEX`
        structure `ullAvailPhys` field.
      - Under macOS, populated with `vm_statistics64_data_t::free_count`.
      - Under Linux, populated with `/proc/meminfo` `xMemFree`.
      - Not available on other platforms.
    type: string
    permissions: ["public"]

  AvailableVirtualMemory:
    data_reviews:
      - unknown
    description: |
      Amount of free virtual memory in bytes
      - Under Windows, populated with the contents of the `MEMORYSTATUSEX`
        structure `ullAvailVirtual` field.
      - Under Linux, populated with `/proc/meminfo` `MemAvailable`.
      - Not available on other platforms.
      - For macOS, see `AvailableSwapMemory`, `AvailablePhysicalMemory`,
        and `PurgeablePhysicalMemory`.
    type: string
    permissions: ["public"]

  BackgroundTaskName:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1697875#c8
    description: >
      If the app was invoked in background task mode via
      `--backgroundtask <task name>`, the string "task name".
    permissions: ["public"]
    type: string

  Breadcrumbs:
    data_reviews:
      - unknown
    description: >
      Trail of events that occurred before a report. this will consist of
      multiple breadcrumbs with timestamp, message, category, level, type and
      data in JSON format.
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1671276
    type: string
    permissions: ["protected"]

  BuildID:
    data_reviews:
      - unknown
    description: |
      The unique build identifier of this version which is typically a
      timestamp of the form `YYYYMMDDHHMMSS`.

      **For Focus, Fenix:**

      This is the build id for the `GeckoView` library used.
    type: string
    permissions: ["public"]

  Comments:
    data_reviews:
      - unknown
    description: >
      Comments from the user at the time of the crash.
    type: string
    permissions: ["protected"]

  CoMarshalInterfaceFailure:
    data_reviews:
      - unknown
    description: >
      Annotation describing the error returned by trying to marshal an object
      via `CoMarshalInterface` during the creation of an IPC proxy stream.
    type: string
    permissions: ["public"]

  CoUnmarshalInterfaceResult:
    data_reviews:
      - unknown
    description: >
      Annotation describing the error returned by trying to unmarshal an object
      via `CoUnmarshalInterface` during the creation of an IPC proxy stream.
    type: string
    permissions: ["public"]

  ContentSandboxCapabilities:
    data_reviews:
      - unknown
    description: >
      List of capabilities of the content process sandbox.
    type: string
    permissions: ["public"]

  ContentSandboxCapable:
    data_reviews:
      - unknown
    description: >
      Set to 1 if the client is capable of content sandboxing.
    type: string
    permissions: ["public"]

  ContentSandboxEnabled:
    data_reviews:
      - unknown
    description: >
      Set to 1 when content process sandboxing is enabled.
    type: string
    permissions: ["public"]

  ContentSandboxLevel:
    data_reviews:
      - unknown
    description: >
      Content sandbox level.
    type: string
    permissions: ["public"]

  CPUMicrocodeVersion:
    data_reviews:
      - unknown
    description: >
      Version of the CPU microcode.
    type: string
    permissions: ["public"]

  CrashTime:
    data_reviews:
      - unknown
    description: >
      Crash time in seconds since the Epoch.
    type: string
    permissions: ["public"]

  DistributionID:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1744902#c3
    description: >
      Product application's distribution ID.
    type: string
    permissions: ["public"]

  DOMFissionEnabled:
    data_reviews:
      - unknown
    description: >
      Set to 1 when DOM fission is enabled, and subframes are potentially loaded
      in a separate process.
    type: string
    permissions: ["public"]

  DOMIPCEnabled:
    data_reviews:
      - unknown
    description: >
      Set to 1 when a tab is running in a content process
    type: string
    permissions: ["public"]

  DumperError:
    data_reviews:
      - unknown
    description: >
      Error message of the minidump writer, in case there was an error during
      dumping.
    type: string
    permissions: ["protected"]

  EMCheckCompatibility:
    data_reviews:
      - unknown
    description: >
      Set to 1 if add-on compatibility checking is enabled.
    type: string
    permissions: ["public"]

  GMPLibraryPath:
    data_reviews:
      - unknown
    description: >
      Holds the path to the GMP plugin library.
    type: string
    permissions: ["protected"]

  GMPPlugin:
    data_reviews:
      - unknown
    description: >
      Set to 1 if the GMP plugin is enabled.
    type: string
    permissions: ["public"]

  GraphicsCriticalError:
    data_reviews:
      - unknown
    description: >
      Information of a critical error that occurred within the graphics code.
    type: string
    permissions: ["public"]

  GraphicsStartupTest:
    data_reviews:
      - unknown
    description: >
      Set to 1 by the graphics driver crash guard when it's activated.
    type: string
    permissions: ["public"]

  Hang:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1716946#c25
    description: >
      Set if the crash was the result of a hang, with a value which describes
      the type of hang. The value is one of `ui` for user interface hangs or
      `shutdown` for shutdown hangs.
    type: string
    permissions: ["public"]

  HasDeviceTouchScreen:
    data_reviews:
      - unknown
    description: >
      Set to 1 if the device had a touch-screen, this only applies to Firefox
      desktop as on mobile devices we assume a touch-screen is always present.
    type: string
    permissions: ["public"]

  InstallTime:
    data_reviews:
      - unknown
    description: >
      The time when Firefox was installed expressed as seconds since the Epoch
    type: string
    permissions: ["public"]

  ipc_channel_error:
    data_reviews:
      - unknown
    description: >
      Set before a content process crashes because of an IPC channel error,
      holds a description of the error.
    type: string
    permissions: ["public"]

  IPCFatalErrorMsg:
    data_reviews:
      - unknown
    description: >
      Describes a fatal error that occurred during IPC operation.
    type: string
    permissions: ["public"]

  IPCFatalErrorProtocol:
    data_reviews:
      - unknown
    description: >
      Name of the protocol used by IPC when a fatal error occurred.
    type: string
    permissions: ["public"]

  IPCMessageName:
    data_reviews:
      - unknown
    description: >
      Name of the IPC message that caused a crash because it was too large.
    type: string
    permissions: ["public"]

  IPCMessageSize:
    data_reviews:
      - unknown
    description: >
      Size of the IPC message that caused a crash because it was too large.
    type: string
    permissions: ["public"]

  IPCShutdownState:
    data_reviews:
      - unknown
    description: >
      IPC shutdown state, can be set to either `RecvShutdown` or
      `SendFinishShutdown` by a content process while it`s shutting down.
    type: string
    permissions: ["public"]

  IPCSystemError:
    data_reviews:
      - unknown
    description: >
      Description of the last system error that occurred during IPC operation.
    type: string
    permissions: ["public"]

  IsGarbageCollecting:
    data_reviews:
      - unknown
    description: >
      If true then the JavaScript garbage collector was running when the crash
      occurred.
    type: string
    permissions: ["public"]

  JavaException:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1671654#c1
    description: |
      JSON structured Java stack trace, only present on Firefox for Android if
      we encounter an uncaught Java exception.

      Parts of the JSON structure can contain sensitive data.
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1671654
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1675560
    type: string
    permissions: ["protected"]

  JavaStackTrace:
    data_reviews:
      - unknown
    description: |
      Java stack trace, only present on Firefox for Android if we encounter an
      uncaught Java exception. This is an unstructured string.

      Parts of the string can contain sensitive data.
    type: string
    permissions: ["protected"]

  JSLargeAllocationFailure:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1804095#c3
    description: >
      A large allocation couldn't be satisfied. The annotation may contain the
      `Reporting`, `Reported` or `Recovered` value. The first one means that we
      crashed while responding to the OOM condition (possibly while running a
      memory-pressure observers), the second that we crashed after having tried
      to free some memory, and the last that the GC had managed to free enough
      memory to satisfy the allocation.
    type: string
    permissions: ["public"]

  MacAvailableMemorySysctl:
    data_reviews:
      - unknown
    description: >
      The value of the available memory sysctl `kern.memorystatus_level`.
      Expected to be a percentage integer value.
    type: string
    permissions: ["public"]

  MacMemoryPressure:
    data_reviews:
      - unknown
    description: |
      The current memory pressure state as provided by the macOS memory
      pressure dispatch source. The annotation value is one of `Normal` for no
      memory pressure, `Unset` indicating a memory pressure event has not been
      received, `Warning` or `Critical` mapping to the system memory pressure
      levels, or `Unexpected` for an unexpected level.

      This is a Mac-specific annotation.
    type: string
    permissions: ["public"]

  MacMemoryPressureCriticalTime:
    data_reviews:
      - unknown
    description: >
      The time when the memory pressure state last transitioned to `Critical`
      expressed as seconds since the Epoch.
    type: string
    permissions: ["public"]

  MacMemoryPressureNormalTime:
    data_reviews:
      - unknown
    description: >
      The time when the memory pressure state last transitioned to `Normal`
      expressed as seconds since the Epoch.
    type: string
    permissions: ["public"]

  MacMemoryPressureSysctl:
    data_reviews:
      - unknown
    description: |
      The value of the memory pressure sysctl
      `kern.memorystatus_vm_pressure_level`. Indicates which memory pressure
      level the system is in at the time of the crash. The expected values are
      one of:

      * 4 (Critical)
      * 2 (Warning)
      * 1 (Normal)
    type: string
    permissions: ["public"]

  MacMemoryPressureWarningTime:
    data_reviews:
      - unknown
    description: >
      The time when the memory pressure state last transitioned to `Warning`
      expressed as seconds since the Epoch.
    type: string
    permissions: ["public"]

  ModuleSignatureInfo:
    data_reviews:
      - unknown
    description: Module signature information.
    type: string
    permissions: ["protected"]

  MozCrashReason:
    data_reviews:
      - unknown
    description: |
      Plaintext description of why Firefox crashed, this is usually set by
      assertions and the like.

      This can contain sensitive data.
    type: string
    permissions: ["protected"]

  Notes:
    data_reviews:
      - unknown
    description: |
      Miscellaneous notes that can be appended to a crash. Mostly contains
      graphics related notes.
    type: string
    permissions: ["public"]

  OOMAllocationSize:
    data_reviews:
      - unknown
    description: >
      Size of the allocation that caused an out-of-memory condition.
    type: string
    permissions: ["public"]

  PHCAllocStack:
    data_reviews:
      - unknown
    description: >
      The allocation's allocation stack trace, if the crash involved a bad
      access of a special PHC allocation. Encoded as a comma-separated list of
      decimal addresses.
    type: string
    permissions: ["protected"]

  PHCBaseAddress:
    data_reviews:
      - unknown
    description: >
      The allocation's base address, if the crash involved a bad access of a
      special PHC allocation. Encoded as a decimal address.
    type: string
    permissions: ["protected"]

  PHCFreeStack:
    data_reviews:
      - unknown
    description: >
      The allocation's free stack trace, if the crash involved a bad access
      of a special PHC allocation. Encoded as a comma-separated list of decimal
      addresses.
    type: string
    permissions: ["protected"]

  PHCKind:
    data_reviews:
      - unknown
    description: >
      The allocation kind, if the crash involved a bad access of a special PHC
      allocation.
    type: string
    permissions: ["protected"]

  PHCUsableSize:
    data_reviews:
      - unknown
    description: >
      The allocation's usable size, if the crash involved a bad access of a
      special PHC allocation.
    type: string
    permissions: ["protected"]

  PluginFilename:
    data_reviews:
      - unknown
    description: >
      Plugin filename, only the process holding the plugin has this annotation.
    type: string
    permissions: ["public"]

  PluginName:
    data_reviews:
      - unknown
    description: >
      Display name of a plugin, only the process holding the plugin has this
      annotation.
    type: string
    permissions: ["public"]

  PluginVersion:
    data_reviews:
      - unknown
    description: >
      Version of a plugin, only the process holding the plugin has this
      annotation.
    type: string
    permissions: ["public"]

  ProcessType:
    data_reviews:
      - unknown
    description: >
      Type of the process that crashed, the possible values are defined in
      `GeckoProcessTypes.h`.
    type: string
    permissions: ["public"]

  ProductID:
    data_reviews:
      - unknown
    description: >
      Application UUID. For example, `ec8030f7-c20a-464f-9b0e-13a3a9e97384`.
    type: string
    permissions: ["public"]

  ProductName:
    data_reviews:
      - unknown
    description: >
      Application name. For example, `Firefox`.
    type: string
    permissions: ["public"]

  QuotaManagerShutdownTimeout:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1672369#c9
    description: |
      This annotation is present if the quota manager shutdown (resp. the
      shutdown of the quota manager clients) was not finished in time and the
      browser was crashed instead of waiting for the shutdown to finish. The
      status of objects which were blocking completion of the shutdown when
      reaching the timeout is contained in the annotation.

      In the case of IndexedDB, objects are divided into three groups:
      FactoryOperations, LiveDatabases and DatabaseMaintenances.

      In the case of LocalStorage, objects are divided into three groups:
      PrepareDatastoreOperations, Datastores and LiveDatabases.

      In the case of Cache API, objects are in one group only:
      Managers.

      Each group is reported separately and contains the number of objects in
      the group and the status of individual objects in the group (duplicate
      entries are removed): "GroupName: N (objectStatus1, objectStatus2, ...)"
      where N is the number of objects in the group.

      The status of individual objects is constructed by taking selected object
      properties. Properties which contain origin strings are anonymized.

      In addition, intermediate steps are recorded for change events after
      shutdown started. These include the time difference and the type of
      object.
    type: string
    permissions: ["public"]

  ReleaseChannel:
    data_reviews:
      - unknown
    description: >
      The update channel that the product is on. Typically `nightly`, `aurora`,
      `beta`, `release`, or `esr`. This may also be other values like
      `release-cck-partner`.
    type: ["string", "null"]
    examples:
      - "nightly"
      - "aurora"
      - "beta"
      - "release"
      - "esr"
    permissions: ["public"]

  RemoteType:
    data_reviews:
      - unknown
    description: >
      Type of the content process, can be set to `web`, `file` or `extension`.
    type: string
    permissions: ["protected"]

  SafeMode:
    data_reviews:
      - unknown
    description: >
      Set to 1 if the browser was started in safe mode.
    type: string
    permissions: ["public"]

  SecondsSinceLastCrash:
    data_reviews:
      - unknown
    description: >
      Time in seconds since the last crash occurred.
    type: string
    permissions: ["public"]

  ShutdownProgress:
    data_reviews:
      - unknown
    description: >
      Shutdown step at which the browser crashed, can be set to
      `quit-application`, `profile-change-teardown`, `profile-before-change`,
      `xpcom-will-shutdown` or `xpcom-shutdown`.
    type: string
    permissions: ["public"]

  ShutdownReason:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1825917
    description: >
      One out of `Unknown`, `AppClose`, `AppRestart`, `OSForceClose`,
      `OSSessionEnd`, `OSShutdown` or `WinUnexpectedMozQuit`.
    type: string
    permissions: ["public"]

  StartupCrash:
    data_reviews:
      - unknown
    description: >
      If set to 1 then this crash occurred during startup.
    type: string
    permissions: ["public"]

  StartupTime:
    data_reviews:
      - unknown
    description: >
      The time when Firefox was launched expressed in seconds since the Epoch.
    type: string
    permissions: ["public"]

  SubmittedFrom:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1702509#c4
    description: |
      This annotation can hold one of the following five values depending on how
      this crash was submitted by the user:

      - Auto: the user had opted-in to auto-submission
      - Infobar: the user clicked on the infobar to submit the crash
      - AboutCrashes: the user sent the crash from the about:crashes page
      - CrashedTab: the user sent the crash from a crashed tab page
      - Client: the user sent the crash using the crash reporter client
    type: string
    permissions: ["public"]

  SubmittedFromInfobar:
    data_reviews:
      - unknown
    description: >
      Whether or not it was submitted from the infobar.

      Deprecated in favor of SubmittedFrom. Remove in 2023.
    deprecated: true
    type: string
    permissions: ["public"]

  SystemMemoryUsePercentage:
    data_reviews:
      - unknown
    description: >
      Percentage of physical memory in use. This annotation is populated with
      the contents of the `MEMORYSTATUSEX` structure `dwMemoryLoad` field.

      This is Windows-only.
    type: string
    permissions: ["public"]

  TelemetryEnvironment:
    data_reviews:
      - unknown
    description: >
      The telemetry environment in JSON format.
    type: string
    permissions: ["public"]

  Throttleable:
    data_reviews:
      - unknown
    description: >
      Whether Socorro can selectively discard this crash report or not. If set
      to `0` the crash report will always be processed by Socorro. Do not set
      this annotation within Gecko code, it's only supposed to be used by the
      crash reporting machinery.
    type: string
    permissions: ["public"]

  TotalPageFile:
    data_reviews:
      - unknown
    description: |
      Maximum amount of memory that can be committed without extending the
      swap/page file.

      - Under Windows, populated with the contents of the
        `PERFORMANCE_INFORMATION` structure `CommitLimit` field.
      - Under Linux, populated with `/proc/meminfo` `MemTotal + SwapTotal`. The
        swap file typically cannot be extended, so that's a hard limit.
      - Not available on other systems.
    type: string
    permissions: ["public"]

  TotalPhysicalMemory:
    data_reviews:
      - unknown
    description: |
      Amount of physical memory in bytes.

      - Under Windows, populated with the contents of the `MEMORYSTATUSEX`
        structure `ullTotalPhys` field.
      - Under macOS, populated with sysctl `hw.memsize`.
      - Under Linux, populated with `/proc/meminfo` `MemTotal`.
      - Not available on other systems.
    type: string
    permissions: ["public"]

  TotalVirtualMemory:
    data_reviews:
      - unknown
    description: |
      Size of the virtual address space.

      - Under Windows, populated with the contents of the `MEMORYSTATUSEX`
        structure `ullTotalVirtual` field.
      - Not available on other platforms.
    type: string
    permissions: ["public"]

  UptimeTS:
    data_reviews:
      - unknown
    description: >
      Uptime in seconds. This annotation uses a string instead of an integer
      because it has a fractional component.
    type: string
    permissions: ["public"]

  URL:
    data_reviews:
      - unknown
    description: >
      URL being loaded.
    type: string
    permissions: ["protected"]

  useragent_locale:
    data_reviews:
      - unknown
    description: >
      User-agent locale.
    type: string
    permissions: ["public"]

  UtilityActorsName:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1788596#c13
    description: >
      Comma-separated list of IPC actors name running on this Utility process
      instance.
    type: string
    permissions: ["public"]

  UtilityProcessSandboxingKind:
    data_reviews:
      - unknown
    description: >
      The `SandboxingKind` passed for this Utility process instance
    type: string
    permissions: ["public"]

  Vendor:
    data_reviews:
      - unknown
    description: >
      Application vendor. For example, `mozilla`.
    type: string
    permissions: ["public"]

  Version:
    data_reviews:
      - unknown
    description: |
      The product version number.

      For Firefox versions, a value lacking letters indicates a normal release;
      a value with `b` indicates a beta release; a value with `a` indicates
      aurora release; and a value with `esr` indicates an Extended Service
      Release.
    type: string
    permissions: ["public"]

  WindowsErrorReporting:
    data_reviews:
      - unknown
    description: >
      Set to 1 if this crash was intercepted via the Windows Error Reporting
      runtime exception module.
    type: string
    permissions: ["public"]

  Winsock_LSP:
    data_reviews:
      - unknown
    description: >
      Information on winsock LSPs injected in our networking stack.
    type: string
    permissions: ["public"]

  XPCOMSpinEventLoopStack:
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1678330#c15
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1735129#c3
    description: |
      If we crash while some code is spinning manually the event loop on the
      main thread, we will see the stack of nested annotations here.

      If the crashing process was killed (e.g. due to an IPC error), this
      annotation may refer to the parent process that killed it, look out for
      the prefix ("default" means parent) and see bug 1741131 for details.
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1741131
    type: string
    permissions: ["public"]
